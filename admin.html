<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุตูุญุฉ ุงูุฅุฏุงุฑุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-6">
        <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
            <div class="text-center mb-8">
                <svg class="w-20 h-20 mx-auto text-red-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
                <h2 class="text-3xl font-bold text-gray-800">ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ</h2>
                <p class="text-gray-600 mt-2">ูููุฏูุฑูู ููุท</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                    <input type="email" id="adminEmail" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-red-600 focus:outline-none text-lg" placeholder="admin@example.com">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-bold mb-2">ูููุฉ ุงูุณุฑ:</label>
                    <input type="password" id="adminPassword" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-red-600 focus:outline-none text-lg" placeholder="โขโขโขโขโขโขโขโข">
                </div>
                
                <button onclick="adminLogin()" class="w-full bg-red-600 text-white py-3 rounded-lg text-xl font-bold hover:bg-red-700 transition-colors">ุฏุฎูู</button>
                
                <a href="index.html" class="block text-center text-gray-600 hover:text-gray-800 mt-4">ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-red-600 to-red-800 text-white p-6 rounded-lg shadow-lg mb-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">ุตูุญุฉ ุงูุฅุฏุงุฑุฉ</h1>
                    <p class="mt-2">ุฅุฏุงุฑุฉ ุงููุธุงู ูุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ</p>
                </div>
                <button onclick="adminLogout()" class="bg-white text-red-600 px-6 py-2 rounded-lg font-bold hover:bg-gray-100">ุฎุฑูุฌ</button>
            </div>
        </div>

        <!-- Center Name -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุงุณู ุงููุฑูุฒ</h2>
            <div class="flex gap-4">
                <input type="text" id="centerName" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg" placeholder="ุงุณู ุงููุฑูุฒ ุงูุทุจู">
                <button onclick="saveCenterName()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
            </div>
        </div>

        <!-- News Ticker -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู</h2>
            <div class="space-y-4">
                <input type="text" id="newsContent" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ูุญุชูู ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู">
                <div class="flex gap-4 items-center">
                    <label class="text-gray-700">ุณุฑุนุฉ ุงูุชุญุฑู:</label>
                    <input type="number" id="newsSpeed" class="px-4 py-2 border border-gray-300 rounded-lg w-32" value="50" min="10" max="200">
                    <span class="text-gray-600">ุจูุณู/ุซุงููุฉ</span>
                    <button onclick="saveNews()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 mr-auto">ุญูุธ</button>
                </div>
            </div>
        </div>

        <!-- Alert Duration -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ูุฏุฉ ุนุฑุถ ุงูุชูุจูู</h2>
            <div class="flex gap-4 items-center">
                <input type="number" id="alertDuration" class="px-4 py-2 border border-gray-300 rounded-lg w-32" value="5" min="1" max="60">
                <span class="text-gray-600">ุซุงููุฉ</span>
                <button onclick="saveAlertDuration()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
            </div>
        </div>

        <!-- Auto-Cleanup Settings -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุชูุธูู ุงูุชููุงุฆู ููุจูุงูุงุช</h2>
            <div class="space-y-4">
                <div class="flex items-center gap-4">
                    <input type="checkbox" id="autoCleanup" class="w-5 h-5">
                    <label for="autoCleanup" class="text-gray-700 font-bold">ุชูุนูู ุงูุชูุธูู ุงูุชููุงุฆู ุงููููู</label>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <p class="text-sm text-gray-700 mb-2">ุนูุฏ ุงูุชูุนููุ ุณูุชู ุชููุงุฆูุงู ูู ููุชุตู ุงูููู:</p>
                    <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                        <li>ุญุฐู ุงููุฏุงุกุงุช ุงูุฃูุฏู ูู 24 ุณุงุนุฉ</li>
                        <li>ุญุฐู ุงูุชูุจููุงุช ุงูุฃูุฏู ูู 24 ุณุงุนุฉ</li>
                        <li>ุงูุงุญุชูุงุธ ุจุงูุนูุงุฏุงุช ูุงูุฃุทุจุงุก ูุงูุฅุนุฏุงุฏุงุช</li>
                    </ul>
                </div>
                <button onclick="saveAutoCleanup()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
            </div>
        </div>

        <!-- Audio & Video Settings -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุนุฏุงุฏุงุช ุงูุตูุช ูุงูููุฏูู</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-gray-700 mb-2">ูุณุงุฑ ูููุงุช ุงูุตูุช:</label>
                    <input type="text" id="audioPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg" value="audio/">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ูุณุงุฑ ูููุงุช ุงูููุฏูู:</label>
                    <input type="text" id="videoPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg" value="media/">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ูุงุฆูุฉ ุงูููุฏูููุงุช (ูู ููุฏูู ูู ุณุทุฑ):</label>
                    <textarea id="videoList" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg font-mono" placeholder="video1.mp4&#10;video2.mp4&#10;video3.mp4"></textarea>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุงุณุชุฎุฏุงู ูุณุงุฑ ุฏุงุฎูู (Android TV):</label>
                    <input type="checkbox" id="useLocalVideos" class="mr-2">
                    <label for="useLocalVideos" class="text-sm text-gray-600">ุชูุนูู ุงููุตูู ูููููุงุช ุงููุญููุฉ</label>
                    <input type="text" id="localVideoPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg mt-2" placeholder="/sdcard/Videos/">
                    <p class="text-xs text-gray-500 mt-1">ูุซุงู: /sdcard/Videos/ ุฃู /storage/emulated/0/Videos/</p>
                </div>
            </div>
            <div class="mt-4">
                <button onclick="saveMediaSettings()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
            </div>
            <div class="mt-4 bg-yellow-50 border-l-4 border-yellow-500 p-4">
                <p class="text-sm text-gray-700"><strong>ููุงุญุธุฉ:</strong> ูุงุณุชุฎุฏุงู ุงููููุงุช ุงููุญููุฉ ุนูู Android TVุ ุชุฃูุฏ ูู ููุญ ุงูุชุทุจูู ุตูุงุญูุงุช ุงููุตูู ููุชุฎุฒูู.</p>
            </div>
        </div>

        <!-- Clinics Management -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช</h2>
                <button onclick="showAddClinic()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">ุฅุถุงูุฉ ุนูุงุฏุฉ ุฌุฏูุฏุฉ</button>
            </div>
            <div id="clinicsList" class="space-y-3"></div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-gray-700 mb-2">ูุฏุงุก ุนููู ูู ุนูุงุฏุฉ:</label>
                    <select id="callClinicSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"></select>
                    <input type="number" id="callNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑูู ุงูุนููู">
                    <button onclick="callCustomer()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 w-full">ูุฏุงุก</button>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุชูุจูู ุนูู ุงูุดุงุดุฉ:</label>
                    <input type="text" id="alertMessage" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑุณุงูุฉ ุงูุชูุจูู">
                    <button onclick="sendAlert()" class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700 w-full">ุฅุฑุณุงู ุชูุจูู</button>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุชูุจูู ูุตูุญุงุช ุงูุชุญูู:</label>
                    <select id="controlAlertClinic" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"></select>
                    <input type="text" id="controlAlertMessage" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑุณุงูุฉ ุงูุชูุจูู">
                    <button onclick="sendControlAlert()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 w-full">ุฅุฑุณุงู</button>
                </div>
            </div>
            <div class="mt-4">
                <button onclick="resetAllClinics()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุช</button>
            </div>
        </div>

        <!-- Audio Controls -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุชุญูู ุจุงูุตูุช</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-gray-700 mb-2">ุฅุฐุงุนุฉ ููู ุฌุงูุฒ:</label>
                    <select id="instantAudio" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2">
                        <option value="">ุงุฎุชุฑ ููู</option>
                        <option value="instant1.mp3">instant1.mp3</option>
                        <option value="instant2.mp3">instant2.mp3</option>
                        <option value="instant3.mp3">instant3.mp3</option>
                    </select>
                    <button onclick="playInstant()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 w-full">ุชุดุบูู</button>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุชุณุฌูู ุตูุช:</label>
                    <button id="recordBtn" onclick="toggleRecord()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 w-full mb-2">ุจุฏุก ุงูุชุณุฌูู</button>
                    <button id="playRecordBtn" onclick="playRecording()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 w-full" disabled>ุชุดุบูู ุงูุชุณุฌูู</button>
                </div>
            </div>
        </div>

        <!-- Doctors Management -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุงูุฃุทุจุงุก</h2>
                <button onclick="showAddDoctor()" class="bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700">ุฅุถุงูุฉ ุทุจูุจ ุฌุฏูุฏ</button>
            </div>
            <div id="doctorsList" class="space-y-3"></div>
        </div>

        <!-- Video Player Remote Control -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุชุญูู ุจูุดุบู ุงูููุฏูู (ุฌููุน ุงูุดุงุดุงุช)</h2>
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                <button onclick="videoControl('previous')" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-bold">
                    โฎ๏ธ ุงูุณุงุจู
                </button>
                <button onclick="videoControl('play')" class="bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 font-bold">
                    โถ๏ธ ุชุดุบูู
                </button>
                <button onclick="videoControl('pause')" class="bg-yellow-600 text-white px-4 py-3 rounded-lg hover:bg-yellow-700 font-bold">
                    โธ๏ธ ุฅููุงู
                </button>
                <button onclick="videoControl('next')" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-bold">
                    โญ๏ธ ุงูุชุงูู
                </button>
                <button onclick="videoControl('mute')" class="bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 font-bold">
                    ๐ ูุชู
                </button>
            </div>
            <div class="mt-4">
                <label class="block text-gray-700 font-bold mb-2">ูุณุชูู ุงูุตูุช:</label>
                <div class="flex gap-4 items-center">
                    <input type="range" id="videoVolumeControl" min="0" max="100" value="50" class="flex-1" onchange="setVideoVolume(this.value)">
                    <span id="videoVolumeDisplay" class="text-gray-700 font-bold w-16">50%</span>
                </div>
            </div>
        </div>

        <!-- Call Statistics & Reports -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800">ุชูุงุฑูุฑ ูุฅุญุตุงุฆูุงุช ุงููุฏุงุก</h2>
                <button onclick="loadStatistics()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700">ุชุญุฏูุซ</button>
            </div>
            
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-blue-50 rounded-lg p-4">
                    <p class="text-gray-600 text-sm">ุฅุฌูุงูู ุงููุฏุงุกุงุช ุงูููู</p>
                    <p id="totalCalls" class="text-3xl font-bold text-blue-600">0</p>
                </div>
                <div class="bg-green-50 rounded-lg p-4">
                    <p class="text-gray-600 text-sm">ุงูุนูุงุฏุงุช ุงููุดุทุฉ</p>
                    <p id="activeClinics" class="text-3xl font-bold text-green-600">0</p>
                </div>
                <div class="bg-yellow-50 rounded-lg p-4">
                    <p class="text-gray-600 text-sm">ูุชูุณุท ููุช ุงูุงูุชุธุงุฑ</p>
                    <p id="avgWaitTime" class="text-3xl font-bold text-yellow-600">0</p>
                    <p class="text-xs text-gray-500">ุฏูููุฉ</p>
                </div>
                <div class="bg-purple-50 rounded-lg p-4">
                    <p class="text-gray-600 text-sm">ุฃูุซุฑ ุนูุงุฏุฉ ูุดุงุทุงู</p>
                    <p id="mostActiveClinic" class="text-lg font-bold text-purple-600">--</p>
                </div>
            </div>

            <!-- Clinic Details -->
            <div id="clinicStatistics" class="space-y-3"></div>

            <!-- Cleanup Options -->
            <div class="mt-6 p-4 bg-red-50 border-l-4 border-red-500 rounded">
                <h3 class="font-bold text-red-800 mb-2">ุตูุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช</h3>
                <p class="text-sm text-gray-700 mb-4">ูุชุญุณูู ุงูุฃุฏุงุกุ ููููู ุญุฐู ุงูุจูุงูุงุช ุงููุฏููุฉ ุงูุชู ูู ุชุนุฏ ุจุญุงุฌุฉ ุฅูููุง:</p>
                <div class="flex gap-2">
                    <button onclick="cleanupOldData('calls')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm">
                        ๐๏ธ ุญุฐู ุงููุฏุงุกุงุช ุงููุฏููุฉ
                    </button>
                    <button onclick="cleanupOldData('alerts')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm">
                        ๐๏ธ ุญุฐู ุงูุชูุจููุงุช ุงููุฏููุฉ
                    </button>
                    <button onclick="cleanupOldData('all')" class="bg-red-700 text-white px-4 py-2 rounded-lg hover:bg-red-800 text-sm">
                        ๐๏ธ ุญุฐู ูู ุงูุจูุงูุงุช ุงููุคูุชุฉ
                    </button>
                </div>
                <p class="text-xs text-gray-600 mt-2">* ุณูุชู ุงูุงุญุชูุงุธ ุจุงูุนูุงุฏุงุช ูุงูุฃุทุจุงุก ูุงูุฅุนุฏุงุฏุงุช</p>
            </div>
        </div>

        <!-- Back Button -->
        <div class="text-center">
            <a href="index.html" class="inline-block bg-gray-600 text-white px-8 py-3 rounded-lg hover:bg-gray-700">ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
        </div>
    </div>
    </div>

    <!-- Add/Edit Clinic Modal -->
    <div id="clinicModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold text-gray-800 mb-4" id="modalTitle">ุฅุถุงูุฉ ุนูุงุฏุฉ ุฌุฏูุฏุฉ</h3>
            <div class="space-y-4">
                <input type="hidden" id="editClinicId">
                <div>
                    <label class="block text-gray-700 mb-2">ุงุณู ุงูุนูุงุฏุฉ:</label>
                    <input type="text" id="clinicName" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุฑูู ุงูุนูุงุฏุฉ:</label>
                    <input type="number" id="clinicNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุฑูู ุงูุดุงุดุฉ (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ุดุงุดุฉ):</label>
                    <div class="grid grid-cols-4 gap-2">
                        <label class="flex items-center gap-2 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="clinic-screen-checkbox" value="1">
                            <span>ุดุงุดุฉ 1</span>
                        </label>
                        <label class="flex items-center gap-2 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="clinic-screen-checkbox" value="2">
                            <span>ุดุงุดุฉ 2</span>
                        </label>
                        <label class="flex items-center gap-2 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="clinic-screen-checkbox" value="3">
                            <span>ุดุงุดุฉ 3</span>
                        </label>
                        <label class="flex items-center gap-2 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="clinic-screen-checkbox" value="4">
                            <span>ุดุงุดุฉ 4</span>
                        </label>
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ูููุฉ ุงูุณุฑ:</label>
                    <input type="password" id="clinicPassword" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                </div>
                <div class="flex gap-4">
                    <button onclick="saveClinic()" class="flex-1 bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">ุญูุธ</button>
                    <button onclick="closeModal()" class="flex-1 bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700">ุฅูุบุงุก</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Doctor Modal -->
    <div id="doctorModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto">
        <div class="bg-white rounded-lg p-8 max-w-2xl w-full mx-4 my-8">
            <h3 class="text-2xl font-bold text-gray-800 mb-4" id="doctorModalTitle">ุฅุถุงูุฉ ุทุจูุจ ุฌุฏูุฏ</h3>
            <div class="space-y-4">
                <input type="hidden" id="editDoctorId">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 mb-2">ุงูุงุณู:</label>
                        <input type="text" id="doctorName" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2">ุงูููุจ:</label>
                        <input type="text" id="doctorTitle" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ุฏ. / ุฃ.ุฏ. / ุงุณุชุดุงุฑู">
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุงูุนูุงุฏุฉ:</label>
                    <select id="doctorClinic" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></select>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุฑุงุจุท ุงูุตูุฑุฉ (URL):</label>
                    <input type="text" id="doctorImage" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="https://example.com/image.jpg">
                    <p class="text-xs text-gray-500 mt-1">ุฃู ุงุฑูุน ุงูุตูุฑุฉ ุนูู Imgur/Firebase Storage ูุถุน ุงูุฑุงุจุท</p>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ุฃูุงู ุงูุนูู:</label>
                    <div class="grid grid-cols-7 gap-2">
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุฃุญุฏ">
                            <span class="text-xs">ุงูุฃุญุฏ</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุฅุซููู">
                            <span class="text-xs">ุงูุฅุซููู</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุซูุงุซุงุก">
                            <span class="text-xs">ุงูุซูุงุซุงุก</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุฃุฑุจุนุงุก">
                            <span class="text-xs">ุงูุฃุฑุจุนุงุก</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุฎููุณ">
                            <span class="text-xs">ุงูุฎููุณ</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุฌูุนุฉ">
                            <span class="text-xs">ุงูุฌูุนุฉ</span>
                        </label>
                        <label class="flex flex-col items-center gap-1 bg-gray-50 p-2 rounded cursor-pointer hover:bg-gray-100">
                            <input type="checkbox" class="doctor-day-checkbox" value="ุงูุณุจุช">
                            <span class="text-xs">ุงูุณุจุช</span>
                        </label>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 mb-2">ุงูุชูููู (1-5):</label>
                        <input type="number" id="doctorRating" class="w-full px-4 py-2 border border-gray-300 rounded-lg" min="1" max="5" step="0.1" value="5">
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2">ุฑูู ุงูุชููููู:</label>
                        <input type="tel" id="doctorPhone" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="01234567890">
                    </div>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">ููุงุญุธุงุช:</label>
                    <textarea id="doctorNotes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ุฃู ููุงุญุธุงุช ุฅุถุงููุฉ"></textarea>
                </div>
                <div class="flex gap-4">
                    <button onclick="saveDoctor()" class="flex-1 bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700">ุญูุธ</button>
                    <button onclick="closeDoctorModal()" class="flex-1 bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700">ุฅูุบุงุก</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration - ุงุณุชุจุฏู ุจูุนูููุงุช Firebase ุงูุฎุงุตุฉ ุจู
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();

        let mediaRecorder;
        let recordedChunks = [];
        let recordedBlob;
        let currentUser = null;

        // Check authentication status
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                loadSettings();
                loadClinics();
            } else {
                currentUser = null;
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('adminPanel').classList.add('hidden');
            }
        });

        function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            if (!email || !password) {
                alert('ูุฑุฌู ุฅุฏุฎุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงูุณุฑ');
                return;
            }

            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log('ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ');
                })
                .catch((error) => {
                    alert('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู: ' + error.message);
                });
        }

        function adminLogout() {
            if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
                auth.signOut();
            }
        }

        function loadSettings() {
            db.ref('settings').once('value', (snapshot) => {
                const settings = snapshot.val() || {};
                document.getElementById('centerName').value = settings.centerName || 'ุงููุฑูุฒ ุงูุทุจู';
                document.getElementById('newsContent').value = settings.newsContent || 'ูุฑุญุจุงู ุจูู ูู ุงููุฑูุฒ ุงูุทุจู';
                document.getElementById('newsSpeed').value = settings.newsSpeed || 50;
                document.getElementById('alertDuration').value = settings.alertDuration || 5;
                document.getElementById('audioPath').value = settings.audioPath || 'audio/';
                document.getElementById('videoPath').value = settings.videoPath || 'media/';
                document.getElementById('speechRate').value = settings.speechRate || 1;
            });
        }

        function saveCenterName() {
            const name = document.getElementById('centerName').value;
            db.ref('settings/centerName').set(name);
            alert('ุชู ุญูุธ ุงุณู ุงููุฑูุฒ');
        }

        function saveNews() {
            const content = document.getElementById('newsContent').value;
            const speed = document.getElementById('newsSpeed').value;
            db.ref('settings').update({
                newsContent: content,
                newsSpeed: parseInt(speed)
            });
            alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู');
        }

        function saveAlertDuration() {
            const duration = document.getElementById('alertDuration').value;
            db.ref('settings/alertDuration').set(parseInt(duration));
            alert('ุชู ุญูุธ ูุฏุฉ ุงูุชูุจูู');
        }

        function saveAutoCleanup() {
            const enabled = document.getElementById('autoCleanup').checked;
            db.ref('settings/autoCleanup').set(enabled);
            
            if (enabled) {
                // Schedule cleanup for midnight
                scheduleAutoCleanup();
            }
            
            alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุชูุธูู ุงูุชููุงุฆู');
        }

        function scheduleAutoCleanup() {
            // Calculate time until midnight
            const now = new Date();
            const midnight = new Date();
            midnight.setHours(24, 0, 0, 0);
            const timeUntilMidnight = midnight - now;

            setTimeout(() => {
                performAutoCleanup();
                // Schedule next cleanup (24 hours)
                setInterval(performAutoCleanup, 24 * 60 * 60 * 1000);
            }, timeUntilMidnight);
        }

        function performAutoCleanup() {
            const oneDayAgo = Date.now() - (24 * 60 * 60 * 1000);
            
            // Clean calls older than 24 hours
            db.ref('calls').orderByChild('timestamp').endAt(oneDayAgo).once('value', (snapshot) => {
                snapshot.forEach(child => {
                    child.ref.remove();
                });
            });

            // Clean alerts older than 24 hours
            db.ref('alerts').orderByChild('timestamp').endAt(oneDayAgo).once('value', (snapshot) => {
                snapshot.forEach(child => {
                    child.ref.remove();
                });
            });

            // Clean doctor alerts older than 24 hours
            db.ref('doctorAlerts').orderByChild('timestamp').endAt(oneDayAgo).once('value', (snapshot) => {
                snapshot.forEach(child => {
                    child.ref.remove();
                });
            });

            // Clean control alerts older than 24 hours
            db.ref('controlAlerts').orderByChild('timestamp').endAt(oneDayAgo).once('value', (snapshot) => {
                snapshot.forEach(child => {
                    child.ref.remove();
                });
            });

            console.log('Auto-cleanup completed at:', new Date().toLocaleString('ar-EG'));
        }

        function saveMediaSettings() {
            const audioPath = document.getElementById('audioPath').value;
            const videoPath = document.getElementById('videoPath').value;
            const videoListText = document.getElementById('videoList').value;
            const useLocalVideos = document.getElementById('useLocalVideos').checked;
            const localVideoPath = document.getElementById('localVideoPath').value;
            
            const videoList = videoListText.split('\n').filter(v => v.trim()).map(v => v.trim());
            
            db.ref('settings').update({
                audioPath: audioPath,
                videoPath: videoPath,
                videoList: videoList,
                useLocalVideos: useLocalVideos,
                localVideoPath: localVideoPath
            });
            alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุตูุช ูุงูููุฏูู');
        }

        function sendControlAlert() {
            const clinicId = document.getElementById('controlAlertClinic').value;
            const message = document.getElementById('controlAlertMessage').value;
            
            if (!clinicId || !message) {
                alert('ูุฑุฌู ุงุฎุชูุงุฑ ุงูุนูุงุฏุฉ ููุชุงุจุฉ ุงูุฑุณุงูุฉ');
                return;
            }

            db.ref('controlAlerts').push({
                clinicId: clinicId,
                message: message,
                timestamp: Date.now()
            });

            alert('ุชู ุฅุฑุณุงู ุงูุชูุจูู ูุตูุญุฉ ุงูุชุญูู');
            document.getElementById('controlAlertMessage').value = '';
        }

        function loadClinics() {
            db.ref('clinics').on('value', (snapshot) => {
                const clinics = snapshot.val() || {};
                const clinicsList = document.getElementById('clinicsList');
                const callSelect = document.getElementById('callClinicSelect');
                const controlAlertSelect = document.getElementById('controlAlertClinic');
                const doctorClinicSelect = document.getElementById('doctorClinic');
                
                clinicsList.innerHTML = '';
                callSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุนูุงุฏุฉ</option>';
                controlAlertSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุนูุงุฏุฉ</option>';
                doctorClinicSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุนูุงุฏุฉ</option>';
                
                Object.keys(clinics).forEach(id => {
                    const clinic = clinics[id];
                    const screens = Array.isArray(clinic.screens) ? clinic.screens.join(', ') : clinic.screen;
                    
                    // Add to list
                    const div = document.createElement('div');
                    div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                    div.innerHTML = `
                        <div>
                            <span class="font-bold">${clinic.name}</span>
                            <span class="text-gray-600 mr-4">ุฑูู: ${clinic.number}</span>
                            <span class="text-gray-600 mr-4">ุดุงุดุงุช: ${screens}</span>
                            <span class="text-gray-600 mr-4">ุงูุฑูู ุงูุญุงูู: ${clinic.currentNumber || 0}</span>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editClinic('${id}')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">ุชุนุฏูู</button>
                            <button onclick="deleteClinic('${id}')" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">ุญุฐู</button>
                        </div>
                    `;
                    clinicsList.appendChild(div);
                    
                    // Add to selects
                    [callSelect, controlAlertSelect, doctorClinicSelect].forEach(select => {
                        const option = document.createElement('option');
                        option.value = id;
                        option.textContent = clinic.name;
                        select.appendChild(option);
                    });
                });
            });
        }

        function showAddClinic() {
            document.getElementById('modalTitle').textContent = 'ุฅุถุงูุฉ ุนูุงุฏุฉ ุฌุฏูุฏุฉ';
            document.getElementById('editClinicId').value = '';
            document.getElementById('clinicName').value = '';
            document.getElementById('clinicNumber').value = '';
            document.getElementById('clinicPassword').value = '';
            document.querySelectorAll('.clinic-screen-checkbox').forEach(cb => cb.checked = false);
            document.getElementById('clinicModal').classList.remove('hidden');
        }

        function editClinic(id) {
            db.ref('clinics/' + id).once('value', (snapshot) => {
                const clinic = snapshot.val();
                document.getElementById('modalTitle').textContent = 'ุชุนุฏูู ุงูุนูุงุฏุฉ';
                document.getElementById('editClinicId').value = id;
                document.getElementById('clinicName').value = clinic.name;
                document.getElementById('clinicNumber').value = clinic.number;
                document.getElementById('clinicPassword').value = clinic.password;
                
                // Set screens checkboxes
                const screens = Array.isArray(clinic.screens) ? clinic.screens : [clinic.screen];
                document.querySelectorAll('.clinic-screen-checkbox').forEach(cb => {
                    cb.checked = screens.includes(parseInt(cb.value));
                });
                
                document.getElementById('clinicModal').classList.remove('hidden');
            });
        }

        function saveClinic() {
            const id = document.getElementById('editClinicId').value;
            const name = document.getElementById('clinicName').value;
            const number = document.getElementById('clinicNumber').value;
            const password = document.getElementById('clinicPassword').value;
            
            const screens = Array.from(document.querySelectorAll('.clinic-screen-checkbox:checked'))
                .map(cb => parseInt(cb.value));

            if (!name || !number || !password || screens.length === 0) {
                alert('ูุฑุฌู ููุก ุฌููุน ุงูุญููู ูุงุฎุชูุงุฑ ุดุงุดุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู');
                return;
            }

            const clinicData = {
                name: name,
                number: parseInt(number),
                screens: screens,
                password: password,
                currentNumber: 0,
                status: 'active',
                lastCall: null
            };

            if (id) {
                db.ref('clinics/' + id).update(clinicData);
            } else {
                db.ref('clinics').push(clinicData);
            }

            closeModal();
            alert('ุชู ุญูุธ ุงูุนูุงุฏุฉ');
        }

        function deleteClinic(id) {
            if (confirm('ูู ุชุฑูุฏ ุญุฐู ูุฐู ุงูุนูุงุฏุฉุ')) {
                db.ref('clinics/' + id).remove();
                alert('ุชู ุญุฐู ุงูุนูุงุฏุฉ');
            }
        }

        function closeModal() {
            document.getElementById('clinicModal').classList.add('hidden');
        }

        function callCustomer() {
            const clinicId = document.getElementById('callClinicSelect').value;
            const number = document.getElementById('callNumber').value;

            if (!clinicId || !number) {
                alert('ูุฑุฌู ุงุฎุชูุงุฑ ุงูุนูุงุฏุฉ ูุฑูู ุงูุนููู');
                return;
            }

            db.ref('clinics/' + clinicId).once('value', (snapshot) => {
                const clinic = snapshot.val();
                const callData = {
                    clinicId: clinicId,
                    clinicName: clinic.name,
                    number: parseInt(number),
                    timestamp: Date.now()
                };

                db.ref('calls').push(callData);
                db.ref('clinics/' + clinicId).update({
                    currentNumber: parseInt(number),
                    lastCall: Date.now()
                });

                alert('ุชู ูุฏุงุก ุงูุนููู ุฑูู ' + number);
            });
        }

        function sendAlert() {
            const message = document.getElementById('alertMessage').value;
            if (!message) {
                alert('ูุฑุฌู ูุชุงุจุฉ ุฑุณุงูุฉ ุงูุชูุจูู');
                return;
            }

            db.ref('alerts').push({
                message: message,
                timestamp: Date.now()
            });

            alert('ุชู ุฅุฑุณุงู ุงูุชูุจูู');
            document.getElementById('alertMessage').value = '';
        }

        function resetAllClinics() {
            if (confirm('ูู ุชุฑูุฏ ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุชุ')) {
                db.ref('clinics').once('value', (snapshot) => {
                    const clinics = snapshot.val() || {};
                    Object.keys(clinics).forEach(id => {
                        db.ref('clinics/' + id).update({
                            currentNumber: 0,
                            lastCall: null
                        });
                    });
                });
                alert('ุชู ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุช');
            }
        }

        function playInstant() {
            const file = document.getElementById('instantAudio').value;
            if (!file) {
                alert('ูุฑุฌู ุงุฎุชูุงุฑ ููู');
                return;
            }

            // Play audio locally
            const audio = new Audio('audio/' + file);
            audio.play();

            // Broadcast to all display screens
            db.ref('instantAudio').push({
                file: file,
                timestamp: Date.now()
            });
        }

        // Doctors Management
        function showAddDoctor() {
            document.getElementById('doctorModalTitle').textContent = 'ุฅุถุงูุฉ ุทุจูุจ ุฌุฏูุฏ';
            document.getElementById('editDoctorId').value = '';
            document.getElementById('doctorName').value = '';
            document.getElementById('doctorTitle').value = '';
            document.getElementById('doctorClinic').value = '';
            document.getElementById('doctorImage').value = '';
            document.getElementById('doctorRating').value = '5';
            document.getElementById('doctorPhone').value = '';
            document.getElementById('doctorNotes').value = '';
            document.querySelectorAll('.doctor-day-checkbox').forEach(cb => cb.checked = false);
            document.getElementById('doctorModal').classList.remove('hidden');
        }

        function editDoctor(id) {
            db.ref('doctors/' + id).once('value', (snapshot) => {
                const doctor = snapshot.val();
                document.getElementById('doctorModalTitle').textContent = 'ุชุนุฏูู ุงูุทุจูุจ';
                document.getElementById('editDoctorId').value = id;
                document.getElementById('doctorName').value = doctor.name;
                document.getElementById('doctorTitle').value = doctor.title || '';
                document.getElementById('doctorClinic').value = doctor.clinicId;
                document.getElementById('doctorImage').value = doctor.image || '';
                document.getElementById('doctorRating').value = doctor.rating || 5;
                document.getElementById('doctorPhone').value = doctor.phone || '';
                document.getElementById('doctorNotes').value = doctor.notes || '';
                
                const days = doctor.workDays || [];
                document.querySelectorAll('.doctor-day-checkbox').forEach(cb => {
                    cb.checked = days.includes(cb.value);
                });
                
                document.getElementById('doctorModal').classList.remove('hidden');
            });
        }

        function saveDoctor() {
            const id = document.getElementById('editDoctorId').value;
            const name = document.getElementById('doctorName').value;
            const title = document.getElementById('doctorTitle').value;
            const clinicId = document.getElementById('doctorClinic').value;
            const image = document.getElementById('doctorImage').value;
            const rating = parseFloat(document.getElementById('doctorRating').value);
            const phone = document.getElementById('doctorPhone').value;
            const notes = document.getElementById('doctorNotes').value;
            
            const workDays = Array.from(document.querySelectorAll('.doctor-day-checkbox:checked'))
                .map(cb => cb.value);

            if (!name || !clinicId) {
                alert('ูุฑุฌู ููุก ุงูุญููู ุงูุฃุณุงุณูุฉ (ุงูุงุณู ูุงูุนูุงุฏุฉ)');
                return;
            }

            const doctorData = {
                name: name,
                title: title,
                clinicId: clinicId,
                image: image,
                workDays: workDays,
                rating: rating,
                phone: phone,
                notes: notes,
                updatedAt: Date.now()
            };

            if (id) {
                db.ref('doctors/' + id).update(doctorData);
            } else {
                db.ref('doctors').push(doctorData);
            }

            closeDoctorModal();
            alert('ุชู ุญูุธ ุจูุงูุงุช ุงูุทุจูุจ');
            loadDoctors();
        }

        function deleteDoctor(id) {
            if (confirm('ูู ุชุฑูุฏ ุญุฐู ูุฐุง ุงูุทุจูุจุ')) {
                db.ref('doctors/' + id).remove();
                alert('ุชู ุญุฐู ุงูุทุจูุจ');
            }
        }

        function loadDoctors() {
            db.ref('doctors').on('value', (snapshot) => {
                const doctors = snapshot.val() || {};
                const doctorsList = document.getElementById('doctorsList');
                doctorsList.innerHTML = '';
                
                db.ref('clinics').once('value', (clinicsSnapshot) => {
                    const clinics = clinicsSnapshot.val() || {};
                    
                    Object.keys(doctors).forEach(id => {
                        const doctor = doctors[id];
                        const clinic = clinics[doctor.clinicId] || {};
                        
                        const div = document.createElement('div');
                        div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                        div.innerHTML = `
                            <div class="flex items-center gap-4">
                                <img src="${doctor.image || 'https://via.placeholder.com/80'}" class="w-20 h-20 rounded-full object-cover" onerror="this.src='https://via.placeholder.com/80'">
                                <div>
                                    <p class="font-bold text-lg">${doctor.title} ${doctor.name}</p>
                                    <p class="text-gray-600">ุงูุนูุงุฏุฉ: ${clinic.name || 'ุบูุฑ ูุญุฏุฏ'}</p>
                                    <p class="text-gray-600 text-sm">ุฃูุงู ุงูุนูู: ${(doctor.workDays || []).join(', ') || 'ุบูุฑ ูุญุฏุฏ'}</p>
                                    <p class="text-yellow-600">โญ ${doctor.rating || 5}</p>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="editDoctor('${id}')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">ุชุนุฏูู</button>
                                <button onclick="deleteDoctor('${id}')" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">ุญุฐู</button>
                            </div>
                        `;
                        doctorsList.appendChild(div);
                    });
                });
            });
        }

        function closeDoctorModal() {
            document.getElementById('doctorModal').classList.add('hidden');
        }

        // Load doctors on page load
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                loadSettings();
                loadClinics();
                loadDoctors();
            } else {
                currentUser = null;
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('adminPanel').classList.add('hidden');
            }
        });

        async function toggleRecord() {
            const btn = document.getElementById('recordBtn');
            
            if (!mediaRecorder || mediaRecorder.state === 'inactive') {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    recordedChunks = [];

                    mediaRecorder.ondataavailable = (e) => {
                        if (e.data.size > 0) {
                            recordedChunks.push(e.data);
                        }
                    };

                    mediaRecorder.onstop = () => {
                        recordedBlob = new Blob(recordedChunks, { type: 'audio/webm' });
                        document.getElementById('playRecordBtn').disabled = false;
                    };

                    mediaRecorder.start();
                    btn.textContent = 'ุฅููุงู ุงูุชุณุฌูู';
                    btn.classList.remove('bg-red-600', 'hover:bg-red-700');
                    btn.classList.add('bg-yellow-600', 'hover:bg-yellow-700');
                } catch (err) {
                    alert('ุฎุทุฃ ูู ุงููุตูู ูููููุฑูููู');
                }
            } else {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                btn.textContent = 'ุจุฏุก ุงูุชุณุฌูู';
                btn.classList.remove('bg-yellow-600', 'hover:bg-yellow-700');
                btn.classList.add('bg-red-600', 'hover:bg-red-700');
            }
        }

        function playRecording() {
            if (recordedBlob) {
                const audio = new Audio(URL.createObjectURL(recordedBlob));
                audio.play();
            }
        }
    </script>
</body>
</html>
