<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุตูุญุฉ ุงูุฅุฏุงุฑุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .admin-tab { 
            transition: all 0.3s;
            cursor: pointer;
        }
        .admin-tab.active { 
            background: #dc2626;
            color: white;
            border-bottom: 3px solid #991b1b;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
            <div class="text-center mb-8">
                <svg class="w-20 h-20 mx-auto text-red-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                </svg>
                <h2 class="text-3xl font-bold text-gray-800">ุชุณุฌูู ุฏุฎูู ุงูุฅุฏุงุฑุฉ</h2>
                <p class="text-gray-600 mt-2">ูููุฏูุฑูู ููุท</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                    <input type="email" id="adminEmail" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-red-600 focus:outline-none text-lg" placeholder="admin@example.com">
                </div>
                
                <div>
                    <label class="block text-gray-700 font-bold mb-2">ูููุฉ ุงูุณุฑ:</label>
                    <input type="password" id="adminPassword" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-red-600 focus:outline-none text-lg" placeholder="โขโขโขโขโขโขโขโข">
                </div>
                
                <button onclick="adminLogin()" class="w-full bg-red-600 text-white py-3 rounded-lg text-xl font-bold hover:bg-red-700 transition-colors">ุฏุฎูู</button>
                
                <a href="index.html" class="block text-center text-gray-600 hover:text-gray-800 mt-4">ุงูุนูุฏุฉ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ</a>
            </div>
        </div>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" class="hidden">
        <!-- Header -->
        <div class="bg-gradient-to-r from-red-600 to-red-800 text-white p-6 shadow-lg">
            <div class="container mx-auto flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold">ุตูุญุฉ ุงูุฅุฏุงุฑุฉ</h1>
                    <p class="mt-2">ุฅุฏุงุฑุฉ ุงููุธุงู ูุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ</p>
                </div>
                <button onclick="adminLogout()" class="bg-white text-red-600 px-6 py-2 rounded-lg font-bold hover:bg-gray-100">ุฎุฑูุฌ</button>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="bg-white shadow-md border-b sticky top-0 z-40">
            <div class="container mx-auto">
                <div class="flex overflow-x-auto">
                    <button onclick="switchAdminTab('general')" class="admin-tab active px-6 py-4 font-bold whitespace-nowrap" id="tab-general">
                        โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ
                    </button>
                    <button onclick="switchAdminTab('call')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-call">
                        ๐ข ุฅุนุฏุงุฏุงุช ุงููุฏุงุก
                    </button>
                    <button onclick="switchAdminTab('clinics')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-clinics">
                        ๐ฅ ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช
                    </button>
                    <button onclick="switchAdminTab('doctors')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-doctors">
                        ๐จโโ๏ธ ุฅุฏุงุฑุฉ ุงูุฃุทุจุงุก
                    </button>
                    <button onclick="switchAdminTab('attendance')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-attendance">
                        ๐ ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
                    </button>
                    <button onclick="switchAdminTab('requests')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-requests">
                        ๐ ุงูุทูุจุงุช
                    </button>
                    <button onclick="switchAdminTab('complaints')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-complaints">
                        ๐ฌ ุงูุดูุงูู
                    </button>
                    <button onclick="switchAdminTab('reports')" class="admin-tab px-6 py-4 font-bold whitespace-nowrap hover:bg-gray-100" id="tab-reports">
                        ๐ ุงูุชูุงุฑูุฑ
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab Content Container -->
        <div class="container mx-auto px-4 py-6">
            
            <!-- General Settings Tab -->
            <div id="content-general" class="tab-content">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุงุณู ุงููุฑูุฒ</h2>
                    <div class="flex gap-4">
                        <input type="text" id="centerName" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg" placeholder="ุงุณู ุงููุฑูุฒ ุงูุทุจู">
                        <button onclick="saveCenterName()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู</h2>
                    <div class="space-y-4">
                        <input type="text" id="newsContent" class="w-full px-4 py-2 border border-gray-300 rounded-lg" placeholder="ูุญุชูู ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู">
                        <div class="flex gap-4 items-center">
                            <label class="text-gray-700">ุณุฑุนุฉ ุงูุชุญุฑู:</label>
                            <input type="number" id="newsSpeed" class="px-4 py-2 border border-gray-300 rounded-lg w-32" value="50" min="10" max="200">
                            <span class="text-gray-600">ุจูุณู/ุซุงููุฉ</span>
                            <button onclick="saveNews()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 mr-auto">ุญูุธ</button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ูุฏุฉ ุนุฑุถ ุงูุชูุจูู</h2>
                    <div class="flex gap-4 items-center">
                        <input type="number" id="alertDuration" class="px-4 py-2 border border-gray-300 rounded-lg w-32" value="5" min="1" max="60">
                        <span class="text-gray-600">ุซุงููุฉ</span>
                        <button onclick="saveAlertDuration()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุชูุธูู ุงูุชููุงุฆู ููุจูุงูุงุช</h2>
                    <div class="space-y-4">
                        <div class="flex items-center gap-4">
                            <input type="checkbox" id="autoCleanup" class="w-5 h-5">
                            <label for="autoCleanup" class="text-gray-700 font-bold">ุชูุนูู ุงูุชูุธูู ุงูุชููุงุฆู ุงููููู</label>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-700 mb-2">ุนูุฏ ุงูุชูุนููุ ุณูุชู ุชููุงุฆูุงู ูู ููุชุตู ุงูููู:</p>
                            <ul class="list-disc list-inside text-sm text-gray-600 space-y-1">
                                <li>ุญุฐู ุงููุฏุงุกุงุช ุงูุฃูุฏู ูู 24 ุณุงุนุฉ</li>
                                <li>ุญุฐู ุงูุชูุจููุงุช ุงูุฃูุฏู ูู 24 ุณุงุนุฉ</li>
                                <li>ุงูุงุญุชูุงุธ ุจุงูุนูุงุฏุงุช ูุงูุฃุทุจุงุก ูุงูุฅุนุฏุงุฏุงุช</li>
                            </ul>
                        </div>
                        <button onclick="saveAutoCleanup()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ ุงูุฅุนุฏุงุฏุงุช</button>
                    </div>
                </div>
            </div>

            <!-- Call Settings Tab -->
            <div id="content-call" class="tab-content hidden">
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุนุฏุงุฏุงุช ุงูุตูุช</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ูุณุงุฑ ูููุงุช ุงูุตูุช:</label>
                            <input type="text" id="audioPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg" value="audio/">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">ุณุฑุนุฉ ุงููุทู (TTS):</label>
                            <input type="number" id="speechRate" class="w-full px-4 py-2 border border-gray-300 rounded-lg" value="1" min="0.5" max="2" step="0.1">
                            <p class="text-xs text-gray-500 mt-1">ูู 0.5 (ุจุทูุก) ุฅูู 2 (ุณุฑูุน)</p>
                        </div>
                    </div>
                    <button onclick="saveAudioSettings()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุนุฏุงุฏุงุช ุงูููุฏูู</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ูุณุงุฑ ูููุงุช ุงูููุฏูู:</label>
                            <input type="text" id="videoPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg" value="media/">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">ูุงุฆูุฉ ุงูููุฏูููุงุช (ูู ููุฏูู ูู ุณุทุฑ):</label>
                            <textarea id="videoList" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg font-mono" placeholder="video1.mp4&#10;video2.mp4"></textarea>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ุงุณุชุฎุฏุงู ูุณุงุฑ ูุญูู:</label>
                            <input type="checkbox" id="useLocalVideos" class="mr-2">
                            <input type="text" id="localVideoPath" class="w-full px-4 py-2 border border-gray-300 rounded-lg mt-2" placeholder="/sdcard/Videos/">
                        </div>
                    </div>
                    <button onclick="saveVideoSettings()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุญูุธ</button>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุงูุชุญูู ุจูุดุบู ุงูููุฏูู (ุฌููุน ุงูุดุงุดุงุช)</h2>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4">
                        <button onclick="videoControl('previous')" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-bold">โฎ๏ธ ุงูุณุงุจู</button>
                        <button onclick="videoControl('play')" class="bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 font-bold">โถ๏ธ ุชุดุบูู</button>
                        <button onclick="videoControl('pause')" class="bg-yellow-600 text-white px-4 py-3 rounded-lg hover:bg-yellow-700 font-bold">โธ๏ธ ุฅููุงู</button>
                        <button onclick="videoControl('next')" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 font-bold">โญ๏ธ ุงูุชุงูู</button>
                        <button onclick="videoControl('mute')" class="bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 font-bold">๐ ูุชู</button>
                    </div>
                    <div class="mt-4">
                        <label class="block text-gray-700 font-bold mb-2">ูุณุชูู ุงูุตูุช:</label>
                        <div class="flex gap-4 items-center">
                            <input type="range" id="videoVolumeControl" min="0" max="100" value="50" class="flex-1" onchange="setVideoVolume(this.value)">
                            <span id="videoVolumeDisplay" class="text-gray-700 font-bold w-16">50%</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุฐุงุนุฉ ุตูุช ููุฑู</h2>
                    <div class="flex gap-4">
                        <select id="instantAudio" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg">
                            <option value="">ุงุฎุชุฑ ููู</option>
                            <option value="instant1.mp3">instant1.mp3</option>
                            <option value="instant2.mp3">instant2.mp3</option>
                            <option value="instant3.mp3">instant3.mp3</option>
                        </select>
                        <button onclick="playInstant()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">ุชุดุบูู</button>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุฌุฑุงุกุงุช ุณุฑูุนุฉ</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-gray-700 mb-2">ูุฏุงุก ุนููู:</label>
                            <select id="callClinicSelect" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"></select>
                            <input type="number" id="callNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑูู ุงูุนููู">
                            <button onclick="callCustomer()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 w-full">ูุฏุงุก</button>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">ุชูุจูู ุนุงู:</label>
                            <input type="text" id="alertMessage" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑุณุงูุฉ ุงูุชูุจูู">
                            <button onclick="sendAlert()" class="bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700 w-full">ุฅุฑุณุงู</button>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">ุชูุจูู ููุชุญูู:</label>
                            <select id="controlAlertClinic" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"></select>
                            <input type="text" id="controlAlertMessage" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-2" placeholder="ุฑุณุงูุฉ">
                            <button onclick="sendControlAlert()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 w-full">ุฅุฑุณุงู</button>
                        </div>
                    </div>
                    <div class="mt-4">
                        <button onclick="resetAllClinics()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700">ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุช</button>
                    </div>
                </div>
            </div>

<div id="content-clinics" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช</h2>
            <button onclick="showAddClinic()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">ุฅุถุงูุฉ ุนูุงุฏุฉ</button>
        </div>
        <div id="clinicsList" class="space-y-3"></div>
    </div>
</div>

<!-- Doctors Tab -->
<div id="content-doctors" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุงูุฃุทุจุงุก</h2>
            <button onclick="showAddDoctorNew()" class="bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700">ุฅุถุงูุฉ ุทุจูุจ</button>
        </div>
        
        <div class="flex gap-4 mb-4">
            <input type="text" id="searchDoctors" placeholder="ุจุญุซ ุจุงูุงุณู ุฃู ุงูุฑูู" 
                   class="flex-1 px-4 py-2 border border-gray-300 rounded-lg" onkeyup="searchDoctors()">
            <select id="filterSpecialty" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterDoctors()">
                <option value="">ูู ุงูุชุฎุตุตุงุช</option>
            </select>
            <select id="filterStatus" class="px-4 py-2 border border-gray-300 rounded-lg" onchange="filterDoctors()">
                <option value="">ูู ุงูุญุงูุงุช</option>
                <option value="ูุดุท">ูุดุท</option>
                <option value="ูุนูู">ูุนูู</option>
                <option value="ูุฌุงุฒุฉ">ูู ุฅุฌุงุฒุฉ</option>
            </select>
        </div>

        <div id="doctorsListNew" class="space-y-3"></div>
    </div>
</div>

<!-- Attendance Tab -->
<div id="content-attendance" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <h2 class="text-xl font-bold text-gray-800 mb-4">ุฅุฏุงุฑุฉ ุงูุญุถูุฑ ูุงูุงูุตุฑุงู</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-gray-700 font-bold mb-2">ุงุฎุชุฑ ุงูุทุจูุจ:</label>
                <select id="attendanceDoctor" class="w-full px-4 py-2 border border-gray-300 rounded-lg"></select>
            </div>
            <div>
                <label class="block text-gray-700 font-bold mb-2">ุงูุชุงุฑูุฎ:</label>
                <input type="date" id="attendanceDate" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div>
                <label class="block text-gray-700 font-bold mb-2">ููุช ุงูุญุถูุฑ:</label>
                <input type="time" id="checkInTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
            </div>
            <div>
                <label class="block text-gray-700 font-bold mb-2">ููุช ุงูุงูุตุฑุงู:</label>
                <input type="time" id="checkOutTime" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
            </div>
            <div>
                <label class="block text-gray-700 font-bold mb-2">ุงูุญุงูุฉ:</label>
                <select id="attendanceStatus" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    <option value="ุญุงุถุฑ">ุญุงุถุฑ</option>
                    <option value="ุบุงุฆุจ">ุบุงุฆุจ</option>
                    <option value="ุฅุฌุงุฒุฉ">ุฅุฌุงุฒุฉ</option>
                    <option value="ูุฃููุฑูุฉ">ูุฃููุฑูุฉ</option>
                </select>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
            <div>
                <label class="block text-gray-700 font-bold mb-2">ุงูุดููุช:</label>
                <select id="attendanceShift" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
                    <option value="ุตุจุงุญู">ุตุจุงุญู</option>
                    <option value="ูุณุงุฆู">ูุณุงุฆู</option>
                </select>
            </div>
            <div>
                <label class="block text-gray-700 font-bold mb-2">ููุงุญุธุงุช:</label>
                <input type="text" id="attendanceNotes" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
            </div>
        </div>

        <button onclick="saveAttendance()" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">ุญูุธ</button>
    </div>
</div>

<!-- Requests Tab -->
<div id="content-requests" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุทูุจุงุช ุงูุนุงูููู</h2>
            <div class="flex gap-2">
                <button onclick="filterAdminRequests('all')" class="admin-filter-btn bg-gray-200 px-4 py-2 rounded-lg font-bold">
                    ุงููู <span id="countAll">0</span>
                </button>
                <button onclick="filterAdminRequests('pending')" class="admin-filter-btn px-4 py-2 rounded-lg font-bold">
                    ููุฏ ุงููุฑุงุฌุนุฉ <span id="countPending" class="bg-yellow-500 text-white px-2 py-1 rounded-full text-xs ml-1">0</span>
                </button>
                <button onclick="filterAdminRequests('approved')" class="admin-filter-btn px-4 py-2 rounded-lg font-bold">
                    ููุงูู <span id="countApproved">0</span>
                </button>
                <button onclick="filterAdminRequests('rejected')" class="admin-filter-btn px-4 py-2 rounded-lg font-bold">
                    ูุฑููุถ <span id="countRejected">0</span>
                </button>
            </div>
        </div>
        <div id="adminRequestsList" class="space-y-4"></div>
    </div>
</div>

<!-- Complaints Tab -->
<div id="content-complaints" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">ุงูุดูุงูู ูุงูุงูุชุฑุงุญุงุช</h2>
            <div class="flex gap-2">
                <button onclick="filterComplaints('all')" class="complaint-filter-btn bg-gray-200 px-4 py-2 rounded-lg font-bold">ุงููู</button>
                <button onclick="filterComplaints('ุดููู')" class="complaint-filter-btn px-4 py-2 rounded-lg font-bold">ุงูุดูุงูู</button>
                <button onclick="filterComplaints('ุงูุชุฑุงุญ')" class="complaint-filter-btn px-4 py-2 rounded-lg font-bold">ุงูุงูุชุฑุงุญุงุช</button>
                <button onclick="filterComplaints('new')" class="complaint-filter-btn px-4 py-2 rounded-lg font-bold">
                    ุฌุฏูุฏ <span id="newComplaintsCount" class="bg-red-500 text-white px-2 py-1 rounded-full text-xs ml-1">0</span>
                </button>
            </div>
        </div>
        <div id="complaintsList" class="space-y-4"></div>
    </div>
</div>

<!-- Reports Tab -->
<div id="content-reports" class="tab-content hidden">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-bold text-gray-800">ุชูุงุฑูุฑ ูุฅุญุตุงุฆูุงุช ุงููุฏุงุก</h2>
            <button onclick="loadStatistics()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700">ุชุญุฏูุซ</button>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-blue-50 rounded-lg p-4">
                <p class="text-gray-600 text-sm">ุฅุฌูุงูู ุงููุฏุงุกุงุช ุงูููู</p>
                <p id="totalCalls" class="text-3xl font-bold text-blue-600">0</p>
            </div>
            <div class="bg-green-50 rounded-lg p-4">
                <p class="text-gray-600 text-sm">ุงูุนูุงุฏุงุช ุงููุดุทุฉ</p>
                <p id="activeClinics" class="text-3xl font-bold text-green-600">0</p>
            </div>
            <div class="bg-yellow-50 rounded-lg p-4">
                <p class="text-gray-600 text-sm">ูุชูุณุท ููุช ุงูุงูุชุธุงุฑ</p>
                <p id="avgWaitTime" class="text-3xl font-bold text-yellow-600">0</p>
                <p class="text-xs text-gray-500">ุฏูููุฉ</p>
            </div>
            <div class="bg-purple-50 rounded-lg p-4">
                <p class="text-gray-600 text-sm">ุฃูุซุฑ ุนูุงุฏุฉ ูุดุงุทุงู</p>
                <p id="mostActiveClinic" class="text-lg font-bold text-purple-600">--</p>
            </div>
        </div>

        <div id="clinicStatistics" class="space-y-3"></div>

        <div class="mt-6 p-4 bg-red-50 border-l-4 border-red-500 rounded">
            <h3 class="font-bold text-red-800 mb-2">ุตูุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช</h3>
            <p class="text-sm text-gray-700 mb-4">ูุชุญุณูู ุงูุฃุฏุงุกุ ููููู ุญุฐู ุงูุจูุงูุงุช ุงููุฏููุฉ:</p>
            <div class="flex gap-2">
                <button onclick="cleanupOldData('calls')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm">
                    ๐๏ธ ุญุฐู ุงููุฏุงุกุงุช ุงููุฏููุฉ
                </button>
                <button onclick="cleanupOldData('alerts')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm">
                    ๐๏ธ ุญุฐู ุงูุชูุจููุงุช ุงููุฏููุฉ
                </button>
                <button onclick="cleanupOldData('all')" class="bg-red-700 text-white px-4 py-2 rounded-lg hover:bg-red-800 text-sm">
                    ๐๏ธ ุญุฐู ูู ุงูุจูุงูุงุช ุงููุคูุชุฉ
                </button>
            </div>
        </div>
    </div>
</div>

            
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyArFKjBYsFhsPyJPJpjLhH2eSEHlUFEzhI",
            authDomain: "queue-717d5.firebaseapp.com",
            databaseURL: "https://queue-717d5-default-rtdb.firebaseio.com",
            projectId: "queue-717d5",
            storageBucket: "queue-717d5.firebasestorage.app",
            messagingSenderId: "837806460328",
            appId: "1:837806460328:web:f2070b93a2784b1b25619d",
            measurementId: "G-GM30LE46F6"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const auth = firebase.auth();
        const firestore = firebase.firestore();

        let currentUser = null;

        // Tab switching
        function switchAdminTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            
            // Remove active from all buttons
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active', 'bg-red-600', 'text-white');
                btn.classList.add('hover:bg-gray-100');
            });
            
            // Show selected tab
            document.getElementById('content-' + tabName).classList.remove('hidden');
            
            // Activate button
            const btn = document.getElementById('tab-' + tabName);
            btn.classList.add('active', 'bg-red-600', 'text-white');
            btn.classList.remove('hover:bg-gray-100');
            
            // Load data for specific tabs
            if (tabName === 'doctors') loadDoctorsNew();
            if (tabName === 'requests') loadAdminRequests();
            if (tabName === 'complaints') loadComplaints();
            if (tabName === 'reports') loadStatistics();
        }

auth.onAuthStateChanged(async (user) => {
    if (!user) {
        document.getElementById('loginScreen').classList.remove('hidden');
        document.getElementById('adminPanel').classList.add('hidden');
        return;
    }
    
    currentUser = user;
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('adminPanel').classList.remove('hidden');
    
    await loadSettings();
    await loadClinics();
    await loadDoctorsForSelects();
});

function adminLogin() {
    const email = document.getElementById('adminEmail').value;
    const password = document.getElementById('adminPassword').value;

    if (!email || !password) {
        alert('ูุฑุฌู ุฅุฏุฎุงู ุงูุจุฑูุฏ ููููุฉ ุงูุณุฑ');
        return;
    }

    auth.signInWithEmailAndPassword(email, password)
        .catch((error) => {
            alert('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู: ' + error.message);
        });
}

function adminLogout() {
    if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
        auth.signOut();
    }
}

async function loadSettings() {
    const snapshot = await db.ref('settings').once('value');
    const settings = snapshot.val() || {};
    
    document.getElementById('centerName').value = settings.centerName || '';
    document.getElementById('newsContent').value = settings.newsContent || '';
    document.getElementById('newsSpeed').value = settings.newsSpeed || 50;
    document.getElementById('alertDuration').value = settings.alertDuration || 5;
    document.getElementById('audioPath').value = settings.audioPath || 'audio/';
    document.getElementById('speechRate').value = settings.speechRate || 1;
    document.getElementById('videoPath').value = settings.videoPath || 'media/';
    document.getElementById('autoCleanup').checked = settings.autoCleanup || false;
    
    if (settings.videoList) {
        document.getElementById('videoList').value = settings.videoList.join('\n');
    }
}

function saveCenterName() {
    const name = document.getElementById('centerName').value;
    db.ref('settings/centerName').set(name);
    alert('ุชู ุญูุธ ุงุณู ุงููุฑูุฒ');
}

function saveNews() {
    const content = document.getElementById('newsContent').value;
    const speed = parseInt(document.getElementById('newsSpeed').value);
    db.ref('settings').update({ newsContent: content, newsSpeed: speed });
    alert('ุชู ุญูุธ ุงูุดุฑูุท ุงูุฅุฎุจุงุฑู');
}

function saveAlertDuration() {
    const duration = parseInt(document.getElementById('alertDuration').value);
    db.ref('settings/alertDuration').set(duration);
    alert('ุชู ุญูุธ ูุฏุฉ ุงูุชูุจูู');
}

function saveAutoCleanup() {
    const enabled = document.getElementById('autoCleanup').checked;
    db.ref('settings/autoCleanup').set(enabled);
    alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุชูุธูู ุงูุชููุงุฆู');
}

function saveAudioSettings() {
    const audioPath = document.getElementById('audioPath').value;
    const speechRate = parseFloat(document.getElementById('speechRate').value);
    db.ref('settings').update({ audioPath, speechRate });
    alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูุตูุช');
}

function saveVideoSettings() {
    const videoPath = document.getElementById('videoPath').value;
    const videoListText = document.getElementById('videoList').value;
    const useLocal = document.getElementById('useLocalVideos').checked;
    const localPath = document.getElementById('localVideoPath').value;
    
    const videoList = videoListText.split('\n').filter(v => v.trim());
    
    db.ref('settings').update({
        videoPath,
        videoList,
        useLocalVideos: useLocal,
        localVideoPath: localPath
    });
    alert('ุชู ุญูุธ ุฅุนุฏุงุฏุงุช ุงูููุฏูู');
}

function videoControl(action) {
    db.ref('videoControl').set({
        action: action,
        timestamp: Date.now()
    });
}

function setVideoVolume(value) {
    document.getElementById('videoVolumeDisplay').textContent = value + '%';
    db.ref('videoControl').set({
        action: 'volume',
        value: parseInt(value),
        timestamp: Date.now()
    });
}

function playInstant() {
    const file = document.getElementById('instantAudio').value;
    if (!file) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ููู');
        return;
    }
    
    const audio = new Audio('audio/' + file);
    audio.play();
    
    db.ref('instantAudio').push({
        file: file,
        timestamp: Date.now()
    });
}

async function loadClinics() {
    const snapshot = await db.ref('clinics').once('value');
    const clinics = snapshot.val() || {};
    
    const listDiv = document.getElementById('clinicsList');
    const callSelect = document.getElementById('callClinicSelect');
    const controlAlertSelect = document.getElementById('controlAlertClinic');
    
    listDiv.innerHTML = '';
    callSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุนูุงุฏุฉ</option>';
    controlAlertSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุนูุงุฏุฉ</option>';
    
    Object.keys(clinics).forEach(id => {
        const clinic = clinics[id];
        const screens = Array.isArray(clinic.screens) ? clinic.screens.join(', ') : clinic.screen;
        
        listDiv.innerHTML += `
            <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                <div>
                    <span class="font-bold">${clinic.name}</span>
                    <span class="text-gray-600 mr-4">ุฑูู: ${clinic.number}</span>
                    <span class="text-gray-600 mr-4">ุดุงุดุงุช: ${screens}</span>
                    <span class="text-gray-600 mr-4">ุงูุฑูู: ${clinic.currentNumber || 0}</span>
                </div>
                <div class="flex gap-2">
                    <button onclick="editClinic('${id}')" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">ุชุนุฏูู</button>
                    <button onclick="deleteClinic('${id}')" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">ุญุฐู</button>
                </div>
            </div>
        `;
        
        callSelect.innerHTML += `<option value="${id}">${clinic.name}</option>`;
        controlAlertSelect.innerHTML += `<option value="${id}">${clinic.name}</option>`;
    });
}

function callCustomer() {
    const clinicId = document.getElementById('callClinicSelect').value;
    const number = parseInt(document.getElementById('callNumber').value);

    if (!clinicId || !number) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ุงูุนูุงุฏุฉ ูุฑูู ุงูุนููู');
        return;
    }

    db.ref('clinics/' + clinicId).once('value', (snapshot) => {
        const clinic = snapshot.val();
        
        db.ref('calls').push({
            clinicId: clinicId,
            clinicName: clinic.name,
            number: number,
            timestamp: Date.now()
        });

        db.ref('clinics/' + clinicId).update({
            currentNumber: number,
            lastCall: Date.now()
        });

        alert('ุชู ูุฏุงุก ุงูุนููู ุฑูู ' + number);
    });
}

function sendAlert() {
    const message = document.getElementById('alertMessage').value;
    if (!message) {
        alert('ูุฑุฌู ูุชุงุจุฉ ุฑุณุงูุฉ');
        return;
    }

    db.ref('alerts').push({
        message: message,
        timestamp: Date.now()
    });

    alert('ุชู ุฅุฑุณุงู ุงูุชูุจูู');
    document.getElementById('alertMessage').value = '';
}

function sendControlAlert() {
    const clinicId = document.getElementById('controlAlertClinic').value;
    const message = document.getElementById('controlAlertMessage').value;
    
    if (!clinicId || !message) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ุงูุนูุงุฏุฉ ูุงูุฑุณุงูุฉ');
        return;
    }

    db.ref('controlAlerts').push({
        clinicId: clinicId,
        message: message,
        timestamp: Date.now()
    });

    alert('ุชู ุฅุฑุณุงู ุงูุชูุจูู');
    document.getElementById('controlAlertMessage').value = '';
}

function resetAllClinics() {
    if (confirm('ูู ุชุฑูุฏ ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุชุ')) {
        db.ref('clinics').once('value', (snapshot) => {
            const clinics = snapshot.val() || {};
            Object.keys(clinics).forEach(id => {
                db.ref('clinics/' + id).update({
                    currentNumber: 0,
                    lastCall: null
                });
            });
        });
        alert('ุชู ุชุตููุฑ ุฌููุน ุงูุนูุงุฏุงุช');
    }
}

async function loadStatistics() {
    try {
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const todayTimestamp = today.getTime();

        const callsSnap = await db.ref('calls').orderByChild('timestamp').startAt(todayTimestamp).once('value');
        const calls = callsSnap.val() || {};
        
        const clinicsSnap = await db.ref('clinics').once('value');
        const clinics = clinicsSnap.val() || {};

        const totalCalls = Object.keys(calls).length;
        const activeClinics = Object.values(clinics).filter(c => c.status === 'active').length;

        document.getElementById('totalCalls').textContent = totalCalls;
        document.getElementById('activeClinics').textContent = activeClinics;

        // Calculate per clinic
        const clinicStats = {};
        Object.values(calls).forEach(call => {
            if (!clinicStats[call.clinicId]) {
                clinicStats[call.clinicId] = { count: 0, name: call.clinicName };
            }
            clinicStats[call.clinicId].count++;
        });

        const mostActive = Object.values(clinicStats).sort((a, b) => b.count - a.count)[0];
        document.getElementById('mostActiveClinic').textContent = mostActive ? mostActive.name : '--';

        // Display clinic details
        const statsDiv = document.getElementById('clinicStatistics');
        statsDiv.innerHTML = '';
        
        Object.entries(clinicStats).forEach(([id, data]) => {
            statsDiv.innerHTML += `
                <div class="bg-gray-50 p-4 rounded-lg flex items-center justify-between">
                    <div>
                        <p class="font-bold text-gray-800">${data.name}</p>
                        <p class="text-sm text-gray-600">ุนุฏุฏ ุงููุฏุงุกุงุช: ${data.count}</p>
                    </div>
                </div>
            `;
        });

    } catch (error) {
        console.error('Error loading statistics:', error);
    }
}

async function cleanupOldData(type) {
    if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุงูุจูุงูุงุช ุงููุฏููุฉุ')) return;

    const oneDayAgo = Date.now() - (24 * 60 * 60 * 1000);

    try {
        if (type === 'calls' || type === 'all') {
            const callsSnap = await db.ref('calls').orderByChild('timestamp').endAt(oneDayAgo).once('value');
            callsSnap.forEach(child => child.ref.remove());
        }

        if (type === 'alerts' || type === 'all') {
            const alertsSnap = await db.ref('alerts').orderByChild('timestamp').endAt(oneDayAgo).once('value');
            alertsSnap.forEach(child => child.ref.remove());
        }

        alert('ุชู ุชูุธูู ุงูุจูุงูุงุช ุจูุฌุงุญ');
    } catch (error) {
        console.error('Error cleanup:', error);
        alert('ุฎุทุฃ ูู ุงูุชูุธูู');
    }
}

// Load doctors for select dropdowns
async function loadDoctorsForSelects() {
    const doctorsSnap = await firestore.collection('doctors').get();
    
    const attendanceSelect = document.getElementById('attendanceDoctor');
    attendanceSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงูุทุจูุจ</option>';
    
    doctorsSnap.forEach(doc => {
        const doctor = doc.data();
        attendanceSelect.innerHTML += `<option value="${doc.id}">${doctor.name} - ${doctor.employeeNumber}</option>`;
    });
}

async function saveAttendance() {
    const doctorId = document.getElementById('attendanceDoctor').value;
    const date = document.getElementById('attendanceDate').value;
    const checkIn = document.getElementById('checkInTime').value;
    const checkOut = document.getElementById('checkOutTime').value;
    const status = document.getElementById('attendanceStatus').value;
    const shift = document.getElementById('attendanceShift').value;
    const notes = document.getElementById('attendanceNotes').value;

    if (!doctorId || !date) {
        alert('ูุฑุฌู ุงุฎุชูุงุฑ ุงูุทุจูุจ ูุงูุชุงุฑูุฎ');
        return;
    }

    try {
        const month = date.substring(0, 7);
        
        await firestore.collection('attendance').add({
            doctorId,
            date,
            month,
            checkIn: checkIn ? firebase.firestore.Timestamp.fromDate(new Date(`${date}T${checkIn}`)) : null,
            checkOut: checkOut ? firebase.firestore.Timestamp.fromDate(new Date(`${date}T${checkOut}`)) : null,
            status,
            shift,
            notes,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        alert('ุชู ุญูุธ ุจูุงูุงุช ุงูุญุถูุฑ');
        
        document.getElementById('attendanceDate').value = '';
        document.getElementById('checkInTime').value = '';
        document.getElementById('checkOutTime').value = '';
        document.getElementById('attendanceNotes').value = '';
    } catch (error) {
        console.error('Error:', error);
        alert('ุฎุทุฃ ูู ุญูุธ ุงูุจูุงูุงุช');
    }
}

// Set today's date
document.addEventListener('DOMContentLoaded', () => {
    const today = new Date().toISOString().split('T')[0];
    if (document.getElementById('attendanceDate')) {
        document.getElementById('attendanceDate').value = today;
    }
});
    </script>
</body>
</html>
